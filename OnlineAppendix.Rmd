---
title: "ONLINE APPENDIX: Growth in a Time of Austerity: 
Evidence from the UK"
author: 'Juergen Amann and Paul Middleditch'
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: yes
    highlight: default
    number_sections: true
    code_folding: hide
    
references:
- id: NIESR
  title: An Indicator of Monthly GDP and an Early Estimate of Quarterly GDP Growth
  author:
  - family: Mitchel
    given: James
  - family: Smith
    given: Richard J.
  - family: Weale
    given: Martin R.
  - family: Wright
    given: Stephen
  issue: 115
  publisher: Economic Journal
  page: F108-F129
  type: article-journal
  issued:
    year: 2005
    month: 2
- id: AM2016
  title: Growth in a Time of Austerity Evidence from the UK
  author:
  - family: Amann
    given: Juergen
  - family: Middleditch
    given: Paul
  issue: 1
  publisher: TBT
  page: TBT
  type: article-journal
  issued:
    year: 2016
    month: 1 
- id: Bianchi95
  title: Granger causality tests in the presence of structural changes
  author:
  - family: Bianchi
    given: Marco
  issue: 33
  publisher: Bank of England working paper
  type: article-journal
  issued:
    year: 1995
    month: 5
  URL: 'https://ideas.repec.org/p/boe/boeewp/33.html'
- id: Lut89
  title: The Stability Assumption in Tests of Causality between Money and Income
  author:
  - family: Lutkepohl
    given: H.
  issue: 14
  publisher: Empirical Economics
  page: 139-50
  type: article-journal
  issued:
    year: 1989
  URL: 'https://ideas.repec.org/a/spr/empeco/v14y1989i2p139-50.html'
- id: Rossi05
  title: Optimal Tests for Nested Model Selection with Underlying Parameter Instability
  author:
  - family: Rossi
    given: Barbara
  issue: 02
  publisher: Duke University working paper
  type: article-journal
  issued:
    year: 2002
  URL: 'https://ideas.repec.org/p/duk/dukeec/02-05.html'    
---


```{r, echo = F, message=F, warning=F}
########################################
##   P R E L I M I N A RY    W O R K  ##
########################################

# Clear workspace
rm(list=ls())
#setwd('~/Dropbox/Papers/Time Series Evidence UK/R Scripts')

# Load Packages
library(urca)
library(vars)
library(aod)
library(zoo)
library(tseries)
library(strucchange)
library(fUnitRoots)
library(ggplot2)
library(Quandl)

## Reinhard and Rogoff 2010 data set
source("reinhart_rogoff_functions.R") # Load function
reinhart_rogoff_data.txt = read.table("reinhart_rogoff_data.txt") # Load RR data 
d <- extract_data("debt.ratio", "gdp.threshold") # Extract data
RRuk <- subset(d, d$Country == "UK") # Build subset for the UK

#Load data
##cof <- read.csv("http://www.christophpfeiffer.org/app/download/6938079586/coffee_data.csv", header=T,sep=";")

#Adjust data and date format
##cof["Date"]<-paste(sub("M","-",cof$Date),"-01",sep="")
```

This document reproduces the empirical findings in @AM2016.


# Data 

Some data manipulations are required to derive the monthly data series used in @AM2016. Below, we discuss these calculations and provide visual evidence of the legitimacy of all steps undertaken.

## Gross Government Debt (DoG)


### Raw Data
Quarterly data on gross government debt is readily available (e.g *‘quarterly government debt’* from Eurostat and *‘general government total gross debt’* from the OECDStats.StatExtracts). [^longnote1] However, only United Kingdom Office of National Statistics (UK-ONS) offers *'Public Sector Net Debt'* (PSND from now on) on a monthly basis.[^longnote2]



Below we plot all these three series as well as the (annual) RR 2010 data set against time.

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
data <- ts(read.csv("data.csv"), frequency=4, start=c(1995,1))
OECD_DoG <- data[,1]
OECD_GDPg_py <- data[,2]


# Use Eurostat data
ES_DoG <- Quandl("EUROSTAT/TIPSGO20_27", authcode = Quandl.api_key("YmvimCE1x1zMqPxsaQ5v"),type = "ts")
# Use monthly PSND data from UKONS
PSND_m <- Quandl("UKONS/PUSF_HF6X_M", authcode = Quandl.api_key("YmvimCE1x1zMqPxsaQ5v"),start_date = "1995-01-01", type = "ts")
# Plot for Figure 1
plot(OECD_DoG, main = "Figure 1: Comparing DoG measures", ylab = "Debt/GDP ratio",
ylim = c(30, 90))
lines(ES_DoG, col = "green")
lines(subset(RRuk[, c(1, 3)], RRuk$Year >= "1995"), col = "blue")
lines(PSND_m, col = "red")
legend(1997, 80, col = c("black", "green", "blue", "red"), lwd = c(2.5, 2.5,2.5), c("OECD, quarterly", "Eurostat, quarterly", "Reinhart and Rogoff 2010, annually", "PSND from UKONS, monthly"))
```

### Data Manipulation

Following data availability issues we describe the construction of a series for monthly gross debt for the UK, showing the data manipulations undertaken.  

As quarterly gross debt and quarterly PSND data are freely available, we begin by comparing both series with each other. Note the similar and parallel nature of both series in the plot below.

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
# Use Quandl for quarterly PSND from UKONS
PSND_q <- Quandl("UKONS/PUSF_HF6X_Q", start_date = "1995-01-01", end_date = "2013-12-31", type = "ts",authcode = Quandl.api_key("YmvimCE1x1zMqPxsaQ5v"))
# Plot 2
plot(OECD_DoG, main = "Figure 2: Gross Debt vs PSND for the UK, quarterly data", ylab = "Debt/GDP ratios", ylim = c(30, 90))
lines(PSND_q, col = "red")
legend(1997, 80, c("OECD gross debt, quarterly", "UKONS PSND, quarterly"), lwd = c(2.5, 2.5), col = c("black", "red"))
```


This observation is generally confirmed in the figure below where we plot the difference, in percent points, of both series against time (black line). By inspection we can see that, through the crisis, the difference between gross debt and PNSD has increased. Given the data structure as shown below, this series was then disaggregated from quarterly to monthly data using R's `tempdisagg` package using the Denton-Cholette method (red line in graph below).

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
DoG_diff <- OECD_DoG - PSND_q # Difference of both series

# Use Quandl for quarterly PSND from UKONS
library(tempdisagg) # Package used for termporal disaggregation

# Denton-Cholette method without indicator
dag <- predict(td(DoG_diff ~ 1, method = "denton-cholette" , criterion = "additive", h = 3, to = "monthly")) *3 
# These are the new, interpolated monthly values
delta <- ts(dag, frequency = 12, start = c(1995, 1))
# Plot 3
plot(DoG_diff, ylab = "Difference", main = "Figure 3: Comparing quarterly and montly ratio")
lines(delta, col = "red")
legend(2001, 10, c("Difference between OECD gross debt and UKONS PSND, both quarterly", "Interpolated Difference of OECD and UKONS data, monthly"), lwd = c(2.5, 2.5), col = c("black", "red"))
```

In a next step, we add the disaggregated difference, plotted above (red line), to the monthly PSND series and present in the graph below (cyan line).



```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}

DoG_app <- PSND_m + delta # Generate approximated series

plot(OECD_DoG, main = "Figure 4: Comparing DoG measures", ylab = "Debt/GDP ratio",
ylim = c(30, 90))
lines(ES_DoG, col = "green")
lines(subset(RRuk[, c(1, 3)], RRuk$Year >= "1995"), col = "blue")
lines(PSND_m, col = "red")
lines(DoG_app, col = "cyan")
legend(1995, 90, c("OECD, quarterly", "Eurostat, quarterly", "Reinhart and Rogoff 2010, anually","PSND from UKONS, monthly", "Gross debt using PSND approximation., monthly"),
lwd = c(2.5, 2.5, 2.5, 2.5), col = c("black", "green", "blue", "red", "cyan"))
```

Furthermore we note that this newly derived series appears to display a strong seasonal pattern which we remove in the subsequent step. For this we use "Census X-13", the Seasonal Adjustment Program developed by the United States Census Bureau for this purpose through the R interface `seasonal`.[^longnote3]



The next figure confirms that the strong seasonal pattern could be removed, thereby producing a smooth(er) series. 

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
library(seasonal) # Load seasonal adjustmen pckage
Sys.setenv(X13_PATH = "/usr/lib/x64_bin_x13")
checkX13()
# DoG
DoG_adj <- seas(DoG_app) # Standard Census X-13 routine
DoG_adj <- DoG_adj$data[, 1]
# Plot par(mfrow=c(2,1)) # Adjust plot
plot(DoG_adj, main = "Figure 5: DoG, unadjusted and seasonally adjusted series", ylab = "Debt GDP ratio")
lines(DoG_app, col = "red")
legend(1995, 70, c("Gross debt using PSND approximation., monthly seasonally adjusted", "Gross debt using PSND approximation., monthly unadjusted"), lwd = c(2.5, 2.5), col = c("black", "red"))
```

Finally the plot below compares the newly derived monthly DoG series against OECD and Eurostat data.

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
plot(OECD_DoG, main = "Figure 4: Comparing DoG measures", ylab = "Debt/GDP ratio",
ylim = c(30, 90))
lines(ES_DoG, col = "green")
lines(subset(RRuk[, c(1, 3)], RRuk$Year >= "1995"), col = "blue")

lines(DoG_adj, col = "magenta")
legend(1995, 90, c("OECD, quarterly", "Eurostat, quarterly", "Reinhart and Rogoff 2010, anually","Gross debt using PSND approximation., monthly seasonally adjusted"),
lwd = c(2.5, 2.5, 2.5, 2.5), col = c("black", "green", "blue", "red", "cyan", "magenta"))
```



## GDP Growth Rates (GR)

### Raw Data

For monthly GDP growth rates, we make use of monthly estimates from the *National Institute of Economic and Social Research* (NIESR). This series was estimated following the methodology described in [@NIESR], expressed as an index where 2008 = 100. We present the NIESR series below:

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
# Read monthly GDP estimates by NIESR
gdp_m <- read.csv("NIERS_GDP.csv", header = FALSE) # Read NIESR data
# Plot
plot(ts(gdp_m, start = c(1995, 1), frequency = 12), main = "Figure 6: Monthly GDP estimation",
ylab = "Index, 2008=100")
```

### Data Manipulation

Using these indexed GDP estimates we calculate the *percent growth rate in change over the same month of the previous year* (GR from now on). In order to compare this calculated series with other GDP measures commonly used by researchers, we plot our monthly series (cyan line) against time and vis-a-vis equivalent GDP growth rates provided by UK-ONS (green line), the OECD (black line) and the RR 2010 data (blue line).[^longnote4]




```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
# Use Use Quandl for GDP growth: UK Office of National Statistics
UKONS_GDPg <- Quandl("UKONS/UKEA_IHYR_Q", authcode = Quandl.api_key("YmvimCE1x1zMqPxsaQ5v"), type = "ts")
# Calculate PGR
pgr <- as.numeric() # Build empty data frame
for (i in 1:(length(gdp_m[, 1]) - 12)) {
# Calculate PGR in a loop
pgr_i <- (gdp_m[12 + i, ] - gdp_m[i, ])/gdp_m[i, ] * 100
pgr <- rbind(pgr, pgr_i)
}
pgr <- ts(pgr, start = c(1996, 1), frequency = 12)
# Plot
plot(OECD_GDPg_py, main = "Figure 7: Comparing GDP Growth Rates", ylab = "GDP growth")
lines(UKONS_GDPg, col = "green")
lines(subset(RRuk[, c(1, 4)], RRuk$Year >= "1995"), col = "blue")
lines(pgr, col = "cyan")
legend(1995, -2, c("OECD, quarterly", "UKONS, quarterly", "Reinhart and Rogoff 2010, annual", "PGR, monthly"), lwd = c(2.5, 2.5, 2.5, 2.5), col = c("black", "green", "blue", "cyan"))



library(pastecs)
# Basic summary statistic for GR, monthly
#stat.desc(gr, desc=T, basic=T) 

# Basic summary statistic for DoG, montly
#stat.desc(DoG_adj, desc=T, basic=T) 
```

## Final Data Set

### Summary Statistics


|  |DoG | GR |
| --- |  --- |  --- |
| Min | 35.60 | -7.12 |
| Max | 89.40 | 6.13 |
| Mean | 51.12 | 2.15 |
| Median | 43.89 | 2.69 |
| SE | 11.42 | 0.16 |
| N | 216 | 216 |







### Exploratory Data Analysis

Below we reproduce Figure 1 in @AM2016. 

```{r, echo = F, message=F, warning=F, fig.width=13, fig.height=8}
# Build nice ggplot2 format
    dog_app <- data.frame(seq.Date(as.Date("1995-1-1"), as.Date("2013-12-31"), by="month"),as.numeric(DoG_adj))
    colnames(dog_app)[1] <- "Year"
    colnames(dog_app)[2] <- "Debt to GDP Ratio\n(DoG)"
    pgr_df <- data.frame(seq.Date(as.Date("1996-1-1"), as.Date("2014-5-31"), by="month"),as.numeric(pgr))
    colnames(pgr_df) <- c("Year","GDP Growth Rate\n(GR)")
# Merge Data
    newplotdata <- merge(dog_app, pgr_df, by=c("Year"))
    dat.fig1 <- reshape(newplotdata, direction="long", varying=list(names(newplotdata)[2:3]), v.names="Value", 
                    idvar=c("Year"), timevar="Variable", times=colnames(newplotdata[,-1]))


# Plot Figure 1
( ggplot(na.omit(dat.fig1), aes(x=Year, y=Value, group=Variable, colour = Variable))
 + geom_line(size=1)
  + geom_point(size=1.2)
  + labs(x="Year", y="")
  + theme_classic()
  + facet_grid(Variable ~ ., scales = "free")
  + theme(legend.position=c(0.15, 0.65))
  + scale_colour_discrete(name="Variables",
                          breaks=c("dog_app", "pgr"),
                          labels=c("DoG", "PGR"))
  + geom_vline(xintercept = 13900, colour="darkgray", linetype = "longdash")
  + geom_vline(xintercept = 14500, colour="darkgray")
  + geom_vline(xintercept = 14800, colour="darkgray", linetype = "longdash")
  + theme(text=element_text(size=25)))



# Plot Figure 2
uk_HF2 <- data.frame (Data = "Own Data", 
                      Time = seq(0, 100-100/length(newplotdata$Year), 
                                 100/length(newplotdata$Year)), 
                      gdp.growth = newplotdata[2], 
                      debt.ratio = newplotdata[3])
colnames(uk_HF2) <- c("Data","Time", "debt.ratio","gdp.growth")
uk_RR2 <- data.frame (Data = "Reinhard and Rogoff (2010)", 
                      Time = seq(0, 100-100/length(RRuk$Year), 100/length(RRuk$Year)), 
                      gdp.growth = RRuk$gdp.growth, 
                      debt.ratio = RRuk$debt.ratio)

ggdata <- rbind(uk_RR2,uk_HF2)

(ggplot((ggdata),  aes(x = gdp.growth, y = debt.ratio, group = Data, colour = Data))
 +geom_point(aes(colour = Data), size = 4)
 + theme_classic()
 + theme(legend.position=c(0.25,0.7))
 +labs(x="GDP Growth Rate", y="Debt-to-GDP Ratio")
 + geom_vline(xintercept = 0, colour="darkgray", linetype = "solid")
 + geom_hline(yintercept = 90, colour="darkgray", linetype = "solid")
 + theme(text=element_text(size=25)))
```



# Footnotes

[^longnote1]: Eurostat data: The full data set including meta data can be downloaded from http://epp.urostat.ec.europa.eu/cache/ITY_SDDS/EN/gov_q_ggdebt_esms.htm. OECD.StatExtract quarterly National Accounts (Quarterly Public Sectors Debt, percent of GDP; data can
be found at http://stats.oecd.org/Index.aspx?DataSetCode=GOV_DEBT.

[^longnote2]: Available at http://www.quandl.com/UKONS/PUSF_HF6X_M-PSND-excluding-NR-as-a-of-GDP-Monthly.

[^longnote3]: Please see https://www.census.gov/srd/www/winx13/. A detailed description of the procedure is presented in the reference manual available at https://www.census.gov/ts/x13as/docX13AS.pdf. R Interface to X-13-ARIMA-SEATS: https://cran.r-project.org/web/packages/seasonal/index.html

[^longnote4]: The OECD data, *quarterly growth rates of real GDP, changes over same quarter, previous year*, is taken from http://stats.oecd.org/index.aspx?queryid=26674 . Data from UK-ONS, *gross domestic product: quarter on quarter previous year: CVM SA (Quarterly)*, is taken from http://stats.oecd.org/index.aspx?queryid=26674.

[^longnote5]:
Rapach and Wohar (2006) use the Bai Perron break point test in a very similar way as we do but don't actually test for Granger-causality (https://www.researchgate.net/profile/Mark_Wohar2/publication/5168421_Regime_Changes_in_International_Real_Interest_Rates_Are_They_a_Monetary_Phenomenon/links/54f467fd0cf299c8d9e748b0.pdf). Giacomini and Rossi (2006) write: "To address these issues and to complement the empirical results in Stock and Watson (1999) and Estrella et al. (2003), we therefore consider the test proposed by Elliott and Mueller (2003), which has optimal power against multiple structural breaks. In addition, we report results using the structural break tests of Andrews (1993), Andrews and Ploberger (1994), Nyblom (1989) and Ghysels, Guay and Hall (1997)" (http://public.econ.duke.edu/~brossi/GiacominiRossiOxfordBullettin2006.pdf). In line with the other two papers, Chen, Rogoff and Rossi (2010) also employ this testing framework on stationary data (http://public.econ.duke.edu/~brossi/ChenRogoffRossi2008.pdf).  
Ajmi et al 2014: Their first empirical step is to use standard unit root tests to show stationarity, then employ a Granger-causality test and then discuss structural stability. (http://www.ipag.fr/wp-content/uploads/recherche/WP/IPAG_WP_2014_296.pdf).
**NOTE FOR PAPER: Maybe we want to extend this literature list a bit more.**

[^longnote6]:
Titus Awokuse (2002) also run a Toda Yamamoto Granger-causality on the full sample, then test for previous assumed break points using a Chow test, find evidence for a break and re-run the test for the sub sample (http://ageconsearch.umn.edu/bitstream/15823/1/sp020001.pdf). More closely related is the study by Stern and Enflo (2013) who also use unit root tests to define endogenously found break dates that are then introduced into the VAR system. They also use the TY procedure for their subsequent analysis but do not the issue of parameter stability as extensively as we do here (http://faculty.smu.edu/millimet/classes/eco6375/papers/stern%20enflo%202013.pdf).


[^longnote7]: We conduct these tests in R and make use use of the package *strucchange*. For more information please see http://eeecon.uibk.ac.at/~zeileis/papers/Zeileis+Kleiber+Kraemer-2003.pdf and https://cran.r-project.org/web/packages/strucchange/vignettes/strucchange-intro.pdf.
